@implements IDisposable
@inject TabBlazor.Services.IModalService ModalService
@namespace TabBlazor

@foreach (var modalModel in ModalService.Modals.Reverse())
{
    <TabBlazor.Components.Modals.ModalView @key="modalModel" Options=@modalModel.Options Title="@modalModel.Title" OnClosed="@(() => ModalClosed(modalModel))">
        @modalModel.ModalContents
    </TabBlazor.Components.Modals.ModalView>
}

@code {
    protected override void OnInitialized()
    {
        ModalService.OnChanged += StateHasChanged;
    }

    public void Dispose()
    {
        ModalService.OnChanged -= StateHasChanged;
    }

    public void ModalClosed(ModalModel modalModel)
    {
        ModalService.Close();
    }
}
